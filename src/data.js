const article = {
  title: 'News readers become part of the article with PARTicipate',
  author: 'Text: Fabian Oppel, Jason Spinks, Images: Lieke van der Rijk',
  date: '04.03.2018',
  summary:
    'A group of coders, journalists and storytellers recently developed a plugin that restructures the comment section of news articles. The plugin allows paragraph based commenting.',
  sections: [
    {
      image: 'logo.png',
      comments: [
        {
          text: 'nice logoooooo',
          author: '312',
          sources: [],
        },
        {
          text: 'Thanks ;)',
          author: '1337',
          sources: [],
        },
      ],
    },
    {
      text:
        'You’ve probably experienced it before: a fresh article is posted on your favorite news site. You click on it, read the article, and then you don’t bother to get to the comments, because you already know what it’ll look like: somebody’s posted a particularly opinionated comment, and somebody else has reacted to it. Soon all hell breaks loose! There’s a full-blown comment fight going down. Wouldn’t it be nice if comments could actually contribute to journalism',
      comments: [
        {
          text:
            'usually I dont comment at all cause I dont want to become part of a troll army or get trolled by them. Too much stress for me',
          author: '312',
          sources: [],
        },
        {
          text:
            "Oh, that's a lovely idea! Totally with ya, TPM guys! <3 Just read a German article about the topic I liked a lot",
          author: '4512',
          sources: [
            {
              href:
                'https://www.focus.de/digital/internet/hate-speech-was-wir-gegen-den-hass-im-internet-tun-koennen_id_5161900.html',
              upVotes: 0,
              downVotes: 0,
            },
          ],
        },
        {
          text:
            'OMG YAS like for real, the comment sections always blow up - this is such a good initiative!',
          author: '3124',
          sources: [],
        },
      ],
    },
    {
      text:
        'Today, it’s a common strategy for major newsrooms to disable the comment section on explosive topics. Tagesschau, one of Germany’s most reputable newsrooms, has an app in which readers can comment on articles. On many controversial topics, the comment section gets closed ‘due to a comment overload’. Other European newsrooms follow similar strategies to avoid comment walls full of hate.',
      comments: [
        {
          text: 'only idiots with no hobbies comment there',
          author: '31234',
          sources: [],
        },
        {
          text:
            'Cool idea guys! Much better than banning comments in general I think. The guardian supposed something like that:',
          author: '4512',
          sources: [
            {
              href:
                'https://www.theguardian.com/science/brain-flapping/2014/sep/12/comment-sections-toxic-moderation',
              upVotes: 0,
              downVotes: 0,
            },
          ],
        },
        {
          text:
            'Hey! What you are doing is all complete bullshit! Did ya even go to school?Watch this new music video people! Much better than all the crap here..',
          author: '956',
          sources: [
            {
              href: 'https://www.youtube.com/watch?v=5l9jV1oNRyY',
              upVotes: 0,
              downVotes: 0,
            },
          ],
        },
      ],
    },
    {
      text:
        'The Permanent Markers (or TPM for short), a newly-formed team of developers, wondered how a general wall of hate could be prevented and developed PARTicipate, a plugin that makes paragraph based commenting possible - one can comment on individual paragraphs instead of on the entire article. Commenters can add sources to their statements to back their opinion. In addition, a heat map on the side of the article indicates which paragraphs are most commented on, elucidating which information triggers the most responses from readers.',
      comments: [
        {
          text: "You're interested in cheap Viagra?",
          author: '726',
          sources: [],
        },
        {
          text:
            'not necessarily needed but maybe describing where the heat map comes from and giving a picture-example would add some scientific spirit to our idea',
          author: '956',
          sources: [],
        },
      ],
    },
    {
      iframe: 'https://www.thinglink.com/card/1026853118773559297',
      comments: [],
    },
    {
      text:
        '“We’re hoping that this will allow for more on-point comments and avoid hateful comments,” says Fabian Oppel, one of the journalists on the team. The verification system is a big step towards controlling that. A comment and its source are only verified once a certain number of other commenters have confirmed it. But there were other focal points, too: “We felt it was important to increase user interaction and to make readers feel involved in the news stories they read,” says Jason Spinks, the team member who specializes in storytelling. “We’re also aiming to encourage the silent majority to participate in the discussion without them feeling like their opinions will get lost between all the hate,” adds Max Schwendemann, one of TPM’s journalists.',
      comments: [
        {
          text: 'cyka blyat',
          author: '726',
          sources: [],
        },
      ],
    },
    {
      text:
        'The plugin was developed between March 2nd and 4th 2018 during a hackathon at the German American Institute (DAI) in Heidelberg, Germany. It was run by Hackastory, a Dutch company whose goal is to play to empower journalism. A hackathon is like a pressure cooker in which you go from absolutely nothing to building a prototype of ideas for a new product in a short amount of time - two and a half days in the case of this hackathon. The goal of the weekend was simple but challenging: to improve on the existing forms of journalism and also solve the trade’s most pressing issues and having fun all the while.',
      comments: [
        {
          text:
            "Be independent journalists! Why making an advert here? Don't understand",
          author: '827',
          sources: [],
        },
      ],
    },
    {
      text:
        'The plugin was developed between March 2nd and 4th 2018 during a hackathon at the German American Institute (DAI) in Heidelberg, Germany. It was run by Hackastory, a Dutch company whose goal is to play to empower journalism. A hackathon is like a pressure cooker in which you go from absolutely nothing to building a prototype of ideas for a new product in a short amount of time - two and a half days in the case of this hackathon. The goal of the weekend was simple but challenging: to improve on the existing forms of journalism and also solve the trade’s most pressing issues and having fun all the while.',
      comments: [
        {
          text: '#MAGA',
          author: ' 124',
          sources: [],
        },
        {
          text: '#MAGA (the 1st "A" is all about Atlantis, right?)',
          author: ' 421',
          sources: [],
        },
        {
          text: 'I thought we were talking about "Austria"??',
          author: ' 93522',
          sources: [],
        },
      ],
    },
    {
      text:
        'Not only the short time frame was challenging this time around: “As a coach, I was really anxious about the amount of non-journalists in this hackathon, but I feel like the cooperation between the different professions worked surprisingly well,” says Lieke van der Rijk about the Heidelberg hackathon.',
      comments: [
        {
          text: 'FAKE NEWS!!!!!',
          author: '93',
          sources: [],
        },
        {
          text: 'Ohhh STFU Lieke!',
          author: '170',
          sources: [],
        },
      ],
    },
    {
      text:
        'The team around TPM did not know each other before the event. “Thanks to the fantastic coaching we really came together as a team and developed an awesome product from scratch” says Daniel Scholz, one of TPM’s code developers. “It was really cool to get a chance to try out real-time collaborative coding. We used Atom Teletype by GitHub. That was a completely new experience for me. It was great to work together with Daniel on the source code and see it evolve,” says coder Niklas Korz. The two developers wrote the whole source code in a matter of hours.',
      comments: [],
    },
    {
      text:
        'Founded in 2016, the Dutch innovators of hackastory led many hackathons all around the world, bringing together coders, designers and storytellers. Besides organizing hackathons, Hackastory also provides trainings and tools that people can use to innovate in journalism.',
      comments: [
        {
          text:
            'Oh heard about that! Appreciate what #hackerstory is doing! How can I be part of it?',
          author: '23',
          sources: [],
        },
        {
          text:
            'the Prague hackathon was so cool, you guys! when is the next hackathon?',
          author: '682',
          sources: [],
        },
        {
          text: 'Actually it is #hackAstory ! :) You should have a look here:',
          author: '46',
          sources: [
            {
              href: 'https://hackastory.com/',
              upVotes: 24,
              downVotes: 3,
            },
          ],
        },
      ],
    },
    {
      text:
        'The new plugin integrates readers into the article, allowing news consumers to participate in the truth-finding process. “We want to leave a permanent mark by changing the way people comment on news articles,” says Max Schwendemann. Let’s discuss the hell out of the facts instead of raising hell over opinions. Facts matter and PARTicipate makes it possible to contribute to a discourse.',
      comments: [
        {
          text:
            'Is there a newspaper interested in using your idea? If yes, which one? Are there other ideas than yours to try handling the hate-comment problem?',
          author: '930',
          sources: [],
        },
        {
          text: 'Need that! Where can I get the plugin?',
          author: '1045',
          sources: [],
        },
      ],
    },
    {
      image: '/team.jpg',
      caption:
        'Live in action: TPM testing their paper prototype on Paul Klammer, journalist and research assistant at TU Dortmund.',
      comments: [],
    },
    {
      text: `The developing team

Niklas Korz - coder
Fabian Oppel - storyteller
Daniel Scholz - coder
Max Schwendemann - designer
Jason Spinks - storyteller, vice-coach
Lieke van der Rijk - coach`,
      comments: [],
    },
  ],
};

export class Data {
  changeListeners = [];

  constructor() {
    this.article = localStorage.article
      ? JSON.parse(localStorage.article)
      : article;
    this.article = article;
  }

  get totalCommentCount() {
    return this.article.sections.reduce(
      (acc, section) => acc + section.comments.length,
      0,
    );
  }

  triggerChange() {
    localStorage.article = JSON.stringify(this.article);
    this.changeListeners.forEach(listener => {
      listener();
    });
  }

  addChangeListener(listener) {
    this.changeListeners.push(listener);
  }

  addComment(sectionId, comment) {
    const section = this.article.sections[sectionId];
    section.comments = [comment, ...section.comments];
    this.triggerChange();
  }

  upVoteSource(sectionId, commentId, sourceId) {
    const section = this.article.sections[sectionId];
    const comment = section.comments[commentId];
    const source = comment.sources[sourceId];
    source.upVotes += 1;
    this.triggerChange();
  }

  downVoteSource(sectionId, commentId, sourceId) {
    const section = this.article.sections[sectionId];
    const comment = section.comments[commentId];
    const source = comment.sources[sourceId];
    source.downVotes += 1;
    this.triggerChange();
  }
}

export default new Data();
